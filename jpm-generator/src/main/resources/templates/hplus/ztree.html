<!DOCTYPE html>
<html>
<head>
    <title>树</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <link rel="stylesheet" href="../../static/hplus/css/ztreeStyle/bootstrapStyle.css"/>
    <style>
      .tree{
          width: 350px;
          height: auto;
          margin: 0 auto;
          border: 1px #cccccc solid;
      }
    </style>
</head>

<body>
<div class="tree">
    <h1>zTree - 树</h1>
    <ul id="treeDemo" class="ztree"></ul>
</div>

</body>
    <script type="text/javascript" src="../../static/hplus/js/jquery.min.js"></script>
    <script type="text/javascript" src="../../static/hplus/js/plugins/ztree/jquery.ztree.core.js"></script>
    <script type="text/javascript" src="../../static/hplus/js/plugins/ztree/jquery.ztree.excheck.js"></script>
    <script type="text/javascript" src="../../static/hplus/js/plugins/ztree/jquery.ztree.exedit.js"></script>
    <script type="text/javascript">
        <!--
        var setting = {
            view: {
                addHoverDom: addHoverDom,
                removeHoverDom: removeHoverDom,
                selectedMulti: false
            },
            check: {
                enable: true  //是否有选中框
            },
            data: {
                simpleData: {
                    enable: true
                }
            },
            edit: {
                enable: true  //是否可编辑删除
            },
            callback:{
                onCheck:onCheck
            }
        };

        var zNodes =[
            {id:1, pId:0, name:"小树", open:true,nocheck:true},
            {id:101, pId:1, name:"小树1"},
            {id:102, pId:1, name:"小树2"},
            {id:103, pId:1, name:"小树3"},

            {id:2, pId:0, name:"中树", open:false},
            {id:201, pId:2, name:"中树1"},
            {id:202, pId:2, name:"中树2"},
            {id:203, pId:2, name:"中树3"},

            {id:3, pId:0, name:"老树", open:false},
            {id:301, pId:3, name:"老树1"},
            {id:302, pId:3, name:"老树2"},
            {id:303, pId:3, name:"老树3"},

            {id:4, pId:0, name:"枯树", open:false},
            {id:401, pId:4, name:"枯树1"},
            {id:402, pId:4, name:"枯树2"},
            {id:403, pId:4, name:"枯树3"},

            {id:5, pId:0, name:"参天大树", open:false},
            {id:501, pId:5, name:"参天大树1"},
            {id:502, pId:5, name:"参天大树2"},
            {id:503, pId:5, name:"参天大树3"},

            {id:6, pId:0, name:"送仙树", open:true,nocheck:true},
            {id:601, pId:6, name:"送仙树1"},
            {id:602, pId:6, name:"送仙树2"},
            {id:603, pId:6, name:"送仙树3"}
        ];

        $(document).ready(function(){
            $.fn.zTree.init($("#treeDemo"), setting, zNodes);
        });

        var newCount = 1;
        function addHoverDom(treeId, treeNode) {
            var sObj = $("#" + treeNode.tId + "_span");
            if (treeNode.editNameFlag || $("#addBtn_"+treeNode.tId).length>0) return;
            var addStr = "<span class='button add' id='addBtn_" + treeNode.tId
                + "' title='add node' onfocus='this.blur();'></span>";
            sObj.after(addStr);
            var btn = $("#addBtn_"+treeNode.tId);
            if (btn) btn.bind("click", function(){
                var zTree = $.fn.zTree.getZTreeObj("treeDemo");
                zTree.addNodes(treeNode, {id:(100 + newCount), pId:treeNode.id, name:"new node" + (newCount++)});
                return false;
            });
        };
        //获得选中
        function onCheck(e,treeId,treeNode) {
            var treeObj=$.fn.zTree.getZTreeObj("treeDemo");
            nodes=treeObj.getCheckedNodes(true);
            v="";
            for(var i=0;i<nodes.length;i++){
                v+=nodes[i].name+",";
            }
        }
        //获取数据
        function zTreeOnClick(event,treeID,treeNode) {
           method(treeNode.id,treeNode.name)
        }
        function method(id,name) {
            var form=document.getElementById("formId");
            form.id.value=id;
            form.name.value=name;
            form.submit();
        }


        function removeHoverDom(treeId, treeNode) {
            $("#addBtn_"+treeNode.tId).unbind().remove();
        };
        //-->
    </script>

</html>